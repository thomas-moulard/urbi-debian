%% Copyright (C) 2009-2010, Gostai S.A.S.
%%
%% This software is provided "as is" without warranty of any kind,
%% either expressed or implied, including but not limited to the
%% implied warranties of fitness for a particular purpose.
%%
%% See the LICENSE file for more information.

\section{Server}

A \dfn{Server} can listen to incoming connections.  See
\refObject{Socket} for an example.

\subsection{Prototypes}
\begin{refObjects}
\item[Object]
\end{refObjects}

\subsection{Construction}

A \lstinline|Server| is constructed with no argument. At creation, a
new \lstinline|Server| has its own slot \lstinline|connection|. This
slot is an event that is launched when a connection establishes.

\begin{urbiscript}
var s = Server.new|
s.localSlotNames;
[00000001] ["connection"]
\end{urbiscript}

\subsection{Slots}
\begin{urbiscriptapi}
\item[connection]
  The event launched at each incoming connection. This event is
  launched with one argument: the socket of the established connection. This
  connection uses the same \refObject{IoService} as the server.
\begin{urbiscript}
at (s.connection?(var socket))
{
  // This code is run at each connection. 'socket' is the incoming
  // connection.
};
\end{urbiscript}

\item[getIoService]
  Return the \refObject{IoService} used by this socket. Only the default
  \lstinline|IoService| is automatically polled.

\item[host]
  The host on which \this is listening. Raise an error if
  \this is not listening.
\begin{urbiscript}
Server.host;
[00000003:error] !!! host: server not listening
\end{urbiscript}

\item[listen](<host>, <port>)%
  Listen incoming connections with \var{host} and \var{port}.

\item[port]
  The port on which \this is listening. Raise an error if
  \this is not listening.
\begin{urbiscript}
Server.port;
[00000004:error] !!! port: server not listening
\end{urbiscript}

\item[sockets]
  The list of the sockets created at each incoming connection.
\end{urbiscriptapi}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../urbi-sdk"
%%% ispell-dictionary: "american"
%%% ispell-personal-dictionary: "../urbi.dict"
%%% fill-column: 76
%%% End:
